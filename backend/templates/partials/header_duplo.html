<div class="header-wrapper"
    style="position: relative; margin-bottom: {{ styles.header_config.spacing_bottom }}; font-family: {{ styles.header_config.font_family or 'inherit' }}; line-height: {{ styles.header_config.line_height }};">

    <!-- Background Layer -->
    <div class="header-bg" style="
        position: absolute; 
        top: 0; left: 0; right: 0; bottom: 0; 
        background-color: {{ styles.header_config.background_color or 'transparent' }};
        {% if styles.header_config.background_image %}
        background-image: url('{{ styles.header_config.background_image }}');
        background-size: cover;
        background-position: center;
        {% endif %}
        opacity: {{ styles.header_config.background_opacity }};
        z-index: 0;
    "></div>

    <!-- Content Layer -->
    <div class="header-content"
        style="position: relative; z-index: 1; padding: {{ styles.header_config.padding or '0.3cm'}}; box-sizing: border-box; {% if styles.header_config.border_bottom_show %}border-bottom: {{ styles.header_config.border_bottom_width }} {{ styles.header_config.border_bottom_style }} {{ styles.header_config.border_bottom_color or styles.primary_color }};{% endif %}">
        <!-- Duplo Layout: Logo Left, Text Center, Logo Right -->
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="width: 120px; text-align: left;">
                {% if styles.header_config.logo_url %}
                <img src="{{ styles.header_config.logo_url }}" alt="Lodge Logo"
                    style="width: {{ styles.header_config.logo_size or '80px' }}; height: auto;">
                {% endif %}
            </div>

            <div style="flex-grow: 1; margin: 0 15px; text-align: center;">
                <div
                    style="font-size: {{ styles.header_config.font_size_title }}; color: {{ styles.header_config.color_title or styles.header_config.color or styles.primary_color }}; font-weight: bold; margin: {{ styles.header_config.margin_title or '0' }}; text-transform: uppercase;">
                    {{ lodge_title_formatted }} {{ lodge_name }} NÂº {{ lodge_number }}
                </div>
                <div
                    style="font-size: {{ styles.header_config.font_size_subtitle }}; line-height: 1.2; color: {{ styles.header_config.color_subtitle or styles.header_config.color or styles.primary_color }}; margin: {{ styles.header_config.margin_subtitle or '5px 0 0 0' }};">
                    Federada ao {{ lodge_obedience or 'Grande Oriente do Brasil' }} <br>
                    Jurisdicionada ao {{ lodge_subobedience or 'GOB-SP' }}
                </div>
            </div>

            <div style="width: 120px; text-align: right;">
                {% if styles.header_config.logo_obedience %}
                <img src="{{ styles.header_config.logo_obedience }}" alt="Obedience Logo"
                    style="width: {{ styles.header_config.logo_size or '80px' }}; height: auto;">
                {% endif %}
            </div>
        </div>
    </div>
</div>